{"ast":null,"code":"import _objectSpread from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/src/context/UserProvider.js\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { withRouter } from 'react-router-dom';\nvar UserContext = React.createContext();\nvar dataAxios = axios.create();\ndataAxios.interceptors.request.use(function (config) {\n  var token = localStorage.getItem(\"token\");\n  config.headers.Authorization = \"Bearer \".concat(token);\n  return config;\n});\n\nvar UserProvider =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UserProvider, _Component);\n\n  function UserProvider() {\n    var _this;\n\n    _classCallCheck(this, UserProvider);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UserProvider).call(this));\n\n    _this.signup = function (credentials) {\n      axios.post(\"/auth/signup\", credentials).then(function (response) {\n        var _response$data = response.data,\n            user = _response$data.user,\n            token = _response$data.token; // localStorage.setItem(\"user\", JSON.stringify(user))\n\n        localStorage.user = JSON.stringify(user);\n        localStorage.setItem(\"token\", token);\n\n        _this.setState({\n          user: user,\n          token: token\n        }, function () {\n          return _this.props.history.push(\"/posts\");\n        });\n      }).catch(function (err) {\n        return console.log(err.response.data.errMsg);\n      });\n    };\n\n    _this.login = function (credentials) {\n      axios.post(\"/auth/login\", credentials).then(function (response) {\n        var _response$data2 = response.data,\n            user = _response$data2.user,\n            token = _response$data2.token;\n        localStorage.setItem(\"user\", JSON.stringify(user));\n        localStorage.setItem(\"token\", token);\n\n        _this.setState({\n          user: user,\n          token: token\n        }, function () {\n          return _this.props.history.push(\"/posts\");\n        });\n      }).catch(function (err) {\n        return console.log(err.response.data.errMsg);\n      });\n    };\n\n    _this.logout = function () {\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"user\");\n\n      _this.setState({\n        user: {},\n        token: \"\",\n        posts: []\n      });\n    };\n\n    _this.addPost = function (newPost) {\n      dataAxios.post(\"/api/posts\", newPost).then(function (response) {\n        _this.setState(function (prevState) {\n          return {\n            posts: [].concat(_toConsumableArray(prevState.posts), [response.data])\n          };\n        });\n      }).catch(function (err) {\n        return console.log(err.response.data.errMsg);\n      });\n    };\n\n    _this.getUserPosts = function () {\n      dataAxios.get(\"/api/posts\").then(function (res) {\n        _this.setState({\n          posts: res.data\n        });\n      }).catch(function (err) {\n        return console.log(err.response.data.errMsg);\n      });\n    };\n\n    _this.state = {\n      user: JSON.parse(localStorage.getItem(\"user\")) || {},\n      token: localStorage.getItem(\"token\") || \"\",\n      posts: []\n    };\n    return _this;\n  }\n\n  _createClass(UserProvider, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(UserContext.Provider, {\n        value: _objectSpread({}, this.state, {\n          signup: this.signup,\n          login: this.login,\n          logout: this.logout,\n          addPost: this.addPost,\n          getUserPosts: this.getUserPosts\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, this.props.children);\n    }\n  }]);\n\n  return UserProvider;\n}(Component);\n\nexport default withRouter(UserProvider);\nexport var withUser = function withUser(C) {\n  return function (props) {\n    return React.createElement(UserContext.Consumer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, function (value) {\n      return React.createElement(C, Object.assign({}, props, value, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }));\n    });\n  };\n};","map":{"version":3,"sources":["/Users/jessicabeeli/dev/assignments/practice/user-auth-pt2-finish/client/src/context/UserProvider.js"],"names":["React","Component","axios","withRouter","UserContext","createContext","dataAxios","create","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","UserProvider","signup","credentials","post","then","response","data","user","JSON","stringify","setItem","setState","props","history","push","catch","err","console","log","errMsg","login","logout","removeItem","posts","addPost","newPost","prevState","getUserPosts","get","res","state","parse","children","withUser","C","value"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport axios from 'axios'\nimport { withRouter } from 'react-router-dom'\n\nconst UserContext = React.createContext()\n\nconst dataAxios = axios.create()\n\ndataAxios.interceptors.request.use((config) => {\n    const token = localStorage.getItem(\"token\")\n    config.headers.Authorization = `Bearer ${token}`\n    return config\n})\n\n\nclass UserProvider extends Component {\n    constructor(){\n        super()\n        this.state = {\n            user: JSON.parse(localStorage.getItem(\"user\")) || {},\n            token: localStorage.getItem(\"token\") || \"\",\n            posts: []\n        }\n    }\n\n    signup = credentials => {\n        axios.post(\"/auth/signup\", credentials)\n            .then(response => {\n                const { user, token } = response.data\n                // localStorage.setItem(\"user\", JSON.stringify(user))\n                localStorage.user = JSON.stringify(user)\n                localStorage.setItem(\"token\", token)\n                this.setState({ \n                    user, \n                    token \n                }, () => this.props.history.push(\"/posts\"))\n\n            })\n            .catch(err => console.log(err.response.data.errMsg))\n    }\n\n    login = credentials => {\n        axios.post(\"/auth/login\", credentials)\n            .then(response => {\n                const { user, token } = response.data\n                localStorage.setItem(\"user\", JSON.stringify(user))\n                localStorage.setItem(\"token\", token)\n                this.setState({ \n                    user, \n                    token \n                }, () => this.props.history.push(\"/posts\"))\n            })\n            .catch(err => console.log(err.response.data.errMsg))\n    }\n\n    logout = () => {\n        localStorage.removeItem(\"token\")\n        localStorage.removeItem(\"user\")\n        this.setState({\n            user: {},\n            token: \"\",\n            posts: []\n        })\n    }\n\n    addPost = newPost => {\n        dataAxios.post(\"/api/posts\", newPost)\n            .then(response => {\n                this.setState(prevState => ({\n                    posts: [...prevState.posts, response.data]\n                }))\n            })\n            .catch(err => console.log(err.response.data.errMsg))\n    }\n\n    getUserPosts = () => {\n        dataAxios.get(\"/api/posts\")\n            .then(res => {\n                this.setState({\n                    posts: res.data\n                })\n            })\n            .catch(err => console.log(err.response.data.errMsg))\n    }\n\n    render(){\n        return (\n            <UserContext.Provider \n                value={{\n                    ...this.state,\n                    signup: this.signup,\n                    login: this.login,\n                    logout: this.logout,\n                    addPost: this.addPost,\n                    getUserPosts: this.getUserPosts\n                }}>\n                { this.props.children }\n            </UserContext.Provider>\n        )\n    }\n}\n\nexport default withRouter(UserProvider)\n\nexport const withUser = C => props => (\n    <UserContext.Consumer>\n        { value => <C {...props} {...value}/> }\n    </UserContext.Consumer>\n)"]},"metadata":{},"sourceType":"module"}